# ğŸ§  Multiclass Classifier Agent

## Overview
The **Multiclass Classifier Agent** is a modular CLI pipeline for generating datasets and training text classification models (multiclass) in multiple frameworks: **PyTorch**, **TensorFlow**, or **sklearn**. It supports multilingual data, ONNX export, and tokenization/label mapping for deployment.

## ğŸš€ Workflow

1. **Data Generation** (via LLM)
2. **Model Training** (`--platform`: `torch`, `tensorflow`, or `sklearn`)
3. **ONNX Export + Artifacts** (tokenizer, label map)

## ğŸ› ï¸ CLI Usage

### 1. Generate Dataset
```bash
python -m agents.multiclass_classifier_agent \
  -p="Detect news topic in tree types: Sport, Business, Health"
```

### 2. Optional advanced parameters:
```bash
python -m agents.multiclass_classifier_agent \
  --p="Detect news topic in tree types: Sport, Business, Health"\
  --lang="german" \
  --platform="torch" \
  --epochs=10
```

## ğŸ”§ Parameters

| Name            | Description                                              | Required | Default           | Example                                          |
|-----------------|----------------------------------------------------------|----------|-------------------|--------------------------------------------------|
| `-p, --prompt`  | Task description to extract text type and labels from     | âœ…       | -                 | `"Detect news topic in tree types: Sport, Business, Health"` |
| `--lang`        | Language of the dataset generation                        | âŒ       | `english`         | `english`, `ukrainian`, `german`                 |
| `--platform`    | Framework for model training                              | âŒ       | `tensorflow`      | `torch`, `tensorflow`, `sklearn`                 |
| `--batches`     | Total number of batches to generate                       | âŒ       | `300`             | `400`, `500`                                     |
| `--batch-size`  | Number of parallel LLM requests per group                 | âŒ       | `20`              | `20`, `30`, `50`                                 |
| `--epochs`      | Number of training epochs                                 | âŒ       | `10`              | `5`, `10`, `15`                                  |
| `--model`       | LLM model to use for dataset generation                   | âŒ       | `gpt-3.5-turbo`   | `gpt-3.5-turbo`, `gpt-4`, etc.                   |

## ğŸ“¦ Output Structure

```
training_data/
  â””â”€â”€ {type}_train_{language}.csv
testing_data/
  â””â”€â”€ {type}_test_{language}.csv
models/
â”œâ”€â”€ {type}_classifier({language}).onnx
â”œâ”€â”€ {type}_classifier({language}).h5              # (TF only)
â”œâ”€â”€ {type}_classifier({language}).pt              # (Torch only)
â”œâ”€â”€ {type}_classifier({language})_tokenizer.json
â”œâ”€â”€ {type}_classifier({language})_scaler.json
â”œâ”€â”€ {type}_classifier({language})_sklearn_model.joblib (if sklearn)
```

## âœ¨ Features

- âœ… Framework-agnostic training: PyTorch, TensorFlow, sklearn
- ğŸŒ Language-agnostic (LLM-generated dataset)
- ğŸ“¤ Export to ONNX for browser or server inference
- ğŸ§© Tokenizer & LabelMap for deployment
- ğŸ” Fast prototyping & plug-and-play CLI

## ğŸ§ª Examples

### Hate Speech Classifier in Ukrainian (Torch)
```bash
python -m agents.multiclass_classifier_agent \
  -p="Detect hate speech in tree types: Hate, Not_Hate" \
  --lang ukrainian \
  --platform torch \
  --batches 400 \
  --batch-size 20 \
  --epochs 10
```

### Review Sentiment Classifier (TensorFlow)
```bash
python -m agents.multiclass_classifier_agent \
  -p="Detect review sentiment in tree types: Positive, Negative, Neutral" \
  --platform tensorflow
```

### Comment Tone Classifier (Sklearn)
```bash
python -m agents.multiclass_classifier_agent \
  -p="Detect comment tone in tree types: Sarcastic, Serious, Playful" \
  --platform sklearn
```

## ğŸ“¤ Deployment Tips

1. Use the exported `.onnx` model with ONNXRuntime (Python, browser).
2. Load `.json` tokenizer + scaler for text preprocessing.
3. Package model into backend or frontend (e.g., FastAPI, React).
4. Retrain on real-world or multilingual datasets for better generalization.

## ğŸ“± ONNX Model Deployment Demos

### ğŸ¤– Android

ğŸ¬ **Demo: ONNX inference running on Android device**

<p align="center">
   <img src="media/Android runningONNX.gif" width="200" alt="CLI Usage">
</p>

ğŸ”— [Watch Full Video on YouTube](https://www.youtube.com/watch?v=ANDROID_VIDEO_ID)

### ğŸ iOS

ğŸ¬ **Demo: ONNX model working in an iOS app (Swift + CoreML)**

<p align="center">
   <img src="media/OIS runningONNX.gif" width="700" alt="CLI Usage">
</p>

ğŸ”— [Watch iOS Deployment on YouTube](https://www.youtube.com/watch?v=IOS_VIDEO_ID) 